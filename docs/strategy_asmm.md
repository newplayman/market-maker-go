# ASMM策略详解

ASMM (Adaptive Spread Market Making) 是一个基于Avellaneda-Stoikov模型的专业高频做市策略，结合了市场微观结构信号和自适应风险控制。

## 理论基础

ASMM策略基于著名的Avellaneda-Stoikov模型，该模型通过求解Hamilton-Jacobi-Bellman (HJB)方程得到最优做市策略。其核心思想是在最大化期望收益的同时控制库存风险。

### 核心公式

1. **预订价格(Reservation Price)**:
   ```
   r = s - ∂V/∂q * q + 1/2 * σ² * (∂²V/∂q²) * q * dt
   ```

2. **最优价差(Optimal Spread)**:
   ```
   δ_a = δ_b = γ * σ² * dt + (2/γ) * ln(1 + γ/k)
   ```

其中：
- `r` 是预订价格
- `s` 是市场价格
- `V` 是价值函数
- `q` 是库存
- `σ` 是波动率
- `γ` 是风险厌恶系数
- `k` 是市场流动性参数

## 主要特性

### 1. 动态价差调整

ASMM策略根据市场波动率动态调整报价价差：
- 波动率越高，价差越宽
- 在趋势市场中，进一步扩大价差
- 在高波动市场中，显著扩大价差

### 2. 多档报价

策略根据波动率调整挂单间距，实现多档报价：
- 波动率越高，挂单间距越大
- 提供多档流动性，提高成交概率

### 3. 库存偏移

通过库存偏移机制调整报价中心价格：
- 净多头仓位时，偏向卖出
- 净空头仓位时，偏向买入
- 维持delta中性，控制库存风险

### 4. 自适应风险控制

根据市场状态和事后分析自适应调整风险限额：
- 高波动率时降低仓位限制
- 高毒性时降低仓位限制
- 高逆向选择率时降低仓位限制

### 5. 市场状态识别

策略能够识别四种市场状态：
- **平静(Calm)**: 低波动率，低不平衡度
- **上涨趋势(TrendUp)**: 价格上涨，正向不平衡
- **下跌趋势(TrendDown)**: 价格下跌，负向不平衡
- **高波动(HighVol)**: 高波动率

## 参数配置

### 核心参数

| 参数名 | 类型 | 默认值 | 描述 |
|-------|------|--------|------|
| quoteIntervalMs | int | 150 | 报价间隔(毫秒) |
| minSpreadBps | int | 6 | 最小价差(基点) |
| maxSpreadBps | int | 40 | 最大价差(基点) |
| minSpacingBps | int | 4 | 最小挂单间距(基点) |
| maxLevels | int | 3 | 最大挂单层数 |
| baseSize | float64 | 0.01 | 基础订单大小 |
| sizeVolK | float64 | 0.5 | 订单大小对波动率的敏感度 |

### 库存管理参数

| 参数名 | 类型 | 默认值 | 描述 |
|-------|------|--------|------|
| targetPosition | float64 | 0 | 目标仓位 |
| invSoftLimit | float64 | 3 | 仓位软限制 |
| invHardLimit | float64 | 5 | 仓位硬限制 |
| invSkewK | float64 | 1.5 | 仓位偏移系数 |

### 波动率敏感度参数

| 参数名 | 类型 | 默认值 | 描述 |
|-------|------|--------|------|
| volK | float64 | 0.8 | 波动率敏感度 |
| trendSpreadMultiplier | float64 | 1.5 | 趋势市价差倍数 |
| highVolSpreadMultiplier | float64 | 2.0 | 高波动市价差倍数 |
| avoidToxic | bool | true | 是否避开有毒订单 |

## 风险点

### 1. 模型假设风险

ASMM模型基于一系列假设，包括：
- 价格遵循几何布朗运动
- 成交强度呈指数衰减
- 无交易费用

实际情况可能与假设不符，影响策略表现。

### 2. 参数敏感性

策略表现高度依赖参数设置：
- 风险厌恶系数过高可能导致报价过于保守
- 风险厌恶系数过低可能导致库存风险过大

### 3. 极端市场风险

在极端市场条件下（闪崩、黑天鹅事件），策略可能遭受重大损失：
- 需要有效的风控机制及时止损
- 需要动态调整参数适应市场变化

## 调优建议

### 1. 参数调优

- 根据历史数据回测确定最优参数
- 在不同市场环境下使用不同参数集
- 定期根据事后分析结果调整参数

### 2. 风控强化

- 设置严格的仓位限制
- 实施动态风险限额
- 建立紧急止损机制

### 3. 监控体系

- 实时监控关键指标（波动率、不平衡度、仓位等）
- 建立预警机制
- 定期分析策略表现和风险暴露

## 总结

ASMM策略是一个功能完善的高频做市策略，结合了现代金融理论和实践需求。通过动态调整报价、管理库存风险和自适应风控，能够在复杂多变的市场环境中稳定盈利。但同时需要注意模型假设风险和参数敏感性，建立完善的监控和风控体系。